<link rel="stylesheet" href="/stylesheets/stars.css" />
<% layout('layouts/boilerplate')%>
<div class="container shadow-light bg pt-3">
	<h1 class="text-center mb-3">All Campgrounds</h1>
	<form id="fullSearchForm" class="mx-2 mb-3" action="">
		<div class="row">
			<div class="col">
				<form action="">
					<div class="input-group">
						<div class="input-group-prepend">
							<select class="form-select" name="s">
								<option value="all" <% if(query.s === "all") {%>selected<%}%> >All</option>
								<option value="title" <% if(query.s === "title") {%>selected<%}%>>Title</option>
								<option value="location" <% if(query.s === "location") {%>selected<%}%>>Location</option>
								<option value="description" <% if(query.s === "description") {%>selected<%}%>>Description</option>
							</select>
						</div>
						<input
							id="search"
							type="text"
							name="q"
							class="form-control bg border white"
							placeholder="Search"
							aria-label="Search"
							aria-describedby="button-addon2"
							value="<%= query.q %>"
						/>
						<div class="input-group-append">
							<button class="btn btn-outline-light" type="submit" id="button-addon2">
								Search
							</button>
						</div>
					</div>
				</form>
			</div>
			<div class="btn-group col-md-4 mb-3">
				<a
					href="#filter"
					type="button"
					class="btn btn-secondary dropdown-toggle"
					id="dropdownMenuClickableInside" data-bs-toggle="dropdown" data-bs-auto-close="outside"
					aria-expanded="false"

				>
					Filter
				</a>
				<div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuClickableInside">
					<div class="px-3 mb-3">
						<label class="form-label" for="location">Location:</label>
						<select id="country" class="form-select" name="country">
							<option value="">Country</option>
							<% for (let country of countries)  { %> 
							<option ><%= country %> </option>
							<% } %> 


						</select>
						<% for (let country of countries)  { %> 
							<select id="<%= country %>" class="cityClass form-select mt-2" name="city">
								<option value="">City</option>
								<% for (let city of citiesObj[country])  { %> 
									<option><%= city %></option>
								
								<% } %> 
							</select>
							<% } %> 
						
					</div>
					<div class="px-3 mb-3"> 
						<label for="priceRange" class="form-label">Price:</label>
						<div class="row">
							<span class="col-3 text-end">Min.</span>
							<input id="priceMin" name="priceMin" class="priceInput col p-0 px-1" type="number" value="0">
							<span class="col-1">-</span>
							<input id="priceMax" name="priceMax" class="priceInput col p-0 px-1" type="number" value="300">
							<span class="col-3 text-start">Max.</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</form>
	<%- include('../partials/pagination') %> 
	<% for(let campground of campgrounds) { %>

	<div class="shadow-light mb-3 bg rounded">
		<div class="row">
			<div class="col-md-4">
				<a class="cover" href="/campgrounds/<%=campground._id%>">
					<% if (campground.images.length) { %>
					<img
						id="camp-image"
						class="rounded cover"
						src="<%= campground.images[0].url %>"
						alt=""
					/>
					<% } else { %>
					<img
						id="camp-image"
						class="rounded cover"
						src="https://res.cloudinary.com/cateyken/image/upload/v1618999000/campinguru/campfire_wbrg1s.jpg"
						alt=""
					/>
					<% } %>
				</a>
			</div>
			<div class="col-md-8">
				<div class="card-body">
					<h5 class="card-title">
						<a href="/campgrounds/<%=campground._id%>"><%= campground.title %></a>
					</h5>
					<p class="starability-result" data-rating="<%= campground.rating%>">
						Rated: <%= campground.rating %> stars
					</p>
					<h6 class="text-muted"><%= campground.location %></h6>
					<p class="card-text"><%= campground.description %></p>
					<a class="btn btn-outline-primary" href="/campgrounds/<%=campground._id%>"
						>View <%= campground.title %>
					</a>
				</div>
			</div>
		</div>
	</div>
	<% } %> 
	<%- include('../partials/pagination') %>
</div>
<script src="/javascripts/campsFilter.js"></script>
